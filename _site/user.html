<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta charset="utf-8">

  <!-- Page Info -->
  <link rel="shortcut icon" href="/assets/img/Armada-favicon.png">
  <title>User guide – Armada Project</title>
  <meta name="description" content="">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title"
    content="User guide – Armada Project">
  <meta name="twitter:description" content="">
  <meta name="twitter:image:src" content="">

  <!-- Facebook OpenGraph -->
  <meta property="og:title"
    content="User guide – Armada Project" />
  <meta property="og:description" content="" />
  <meta property="og:image" content="" />

  <!--  Fonts and icons -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <!-- Nucleo Icons -->
  <link href="/assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="/assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <link href="/assets/css/font-awesome.css" rel="stylesheet" />
  <link href="/assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- CSS Files -->
  <link rel="stylesheet" href="/assets/styles/styles.css" rel="stylesheet">

  
  <!-- Analytics Code -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id= G-SKPDW30VNF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', ' G-SKPDW30VNF');
  </script>
  

  

</head>

<body>
  
    <nav id="navbar-main" class="navbar navbar-main navbar-expand-lg bg-default navbar-dark headroom">
      

        <div class="container">
          
          <a href="/" class="navbar-brand mr-lg-5">
            <img src="/assets/img/brand/Armada-white-rectangle.png">
          </a>
          

          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_global"
            aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-collapse collapse" id="navbar_global">
            <div class="navbar-collapse-header">
              <div class="row">
                <div class="col-6 collapse-brand">
                  
                  <a href="/">
                    <img src="/assets/img/brand/Armada-dark-rectangle.png">
                  </a>
                  
                </div>
                <div class="col-6 collapse-close">
                  <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar_global"
                    aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
                    <span></span>
                    <span></span>
                  </button>
                </div>
              </div>
            </div>
            <ul class="navbar-nav navbar-nav-hover align-items-lg-center ml-lg-auto">
              
                
                  <li class="nav-item">
                    <a href="/design" class="nav-link">
                      <span class="nav-link-inner--text">Design</span>
                    </a>
                  </li>
                
              
                
                  <li class="nav-item dropdown">
                    <a href="javascript:;" class="nav-link" data-toggle="dropdown" role="button">
                      <span class="nav-link-inner--text">Documentation</span>
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                      
                      <a class="dropdown-item" href="/developer">
                        <i class="ni "></i>
                        Development
                      </a>
                      
                      <a class="dropdown-item" href="/user">
                        <i class="ni "></i>
                        User Guide
                      </a>
                      
                      <a class="dropdown-item" href="/production-install">
                        <i class="ni "></i>
                        Production Install
                      </a>
                      
                    </div>
                  </li>
                
              
                
                  <li class="nav-item">
                    <a href="/quickstart" class="nav-link">
                      <span class="nav-link-inner--text">Quickstart</span>
                    </a>
                  </li>
                
              
                
                  <li class="nav-item">
                    <a href="/contribute" class="nav-link">
                      <span class="nav-link-inner--text">Contribute</span>
                    </a>
                  </li>
                
              
              <li class="nav-item github-logo-header desktop"><a class="" href="https://github.com/G-Research/armada" target="_blank">
                <img src="/assets/img/brand/GitHub-Mark-Light-120px-plus.png" width="40" height="40"></a>
              </li>
              <li class="nav-item mobile">
                <a href="https://github.com/G-Research/armada" class="nav-link" target="_blank">
                  <span class="nav-link-inner--text">Github</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
  <div class="wrapper page">
    
    <!-- Is not a blog post or blog archive or contact page -->
    <!-- Is a page with a banner -->
    <div class="page-header page-header-small header-filter mb-4">
      <div class="page-header-image card-background"
        style="background-image: url(/assets/img/ill/bg_contactus3.svg);"></div>
      <div class="container contentWrapper">
        <div class="row">
          <div class="col-lg-10 mx-auto text-center pt-4">
            <h2 class="display-2 text-white">User guide</h2>
            <h2 class="lead text-white pl-5 pr-5 pb-3 text-center"></h2>
          </div>
        </div>
      </div>
    </div>
    


    <div id="main" class="container">
      <h1 id="user-guide">User guide</h1>

<p>This document is meant to be a guide for new users of how to create and submit Jobs to Armada. Because Armada jobs are run as containers in Kubernetes, a basic understanding of Docker and Kubernetes is required; see, e.g., the following links:</p>

<ul>
  <li><a href="https://docs.docker.com/get-started/overview/">Docker overiew</a></li>
  <li><a href="https://kubernetes.io/docs/concepts/overview/">Kubernetes overview</a></li>
</ul>

<p>For more information about the design of Armada (e.g., how jobs are prioritised), see:</p>

<ul>
  <li><a href="/design.html">System overview</a></li>
</ul>

<p>The Armada workflow is:</p>

<ol>
  <li>Create a job specification, which is a Kubernetes podspec with additional metadata fields specific to Armada.</li>
  <li>Submit the job specification to one of Armada’s job queues.</li>
</ol>

<p>To create a job that sleeps for 60 seconds, start by creating a yaml file with the following contents:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">queue</span><span class="pi">:</span> <span class="s">test</span>
<span class="na">jobSetId</span><span class="pi">:</span> <span class="s">set1</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">priority</span><span class="pi">:</span> <span class="m">0</span>
    <span class="na">podSpecs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">terminationGracePeriodSeconds</span><span class="pi">:</span> <span class="m">0</span>
        <span class="na">restartPolicy</span><span class="pi">:</span> <span class="s">Never</span>
        <span class="na">containers</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">sleep</span>
            <span class="na">imagePullPolicy</span><span class="pi">:</span> <span class="s">IfNotPresent</span>
            <span class="na">image</span><span class="pi">:</span> <span class="s">busybox:latest</span>
            <span class="na">args</span><span class="pi">:</span>
              <span class="pi">-</span> <span class="s">sleep</span>
              <span class="pi">-</span> <span class="s">60s</span>
            <span class="na">resources</span><span class="pi">:</span>
              <span class="na">limits</span><span class="pi">:</span>
                <span class="na">memory</span><span class="pi">:</span> <span class="s">64Mi</span>
                <span class="na">cpu</span><span class="pi">:</span> <span class="s">150m</span>
              <span class="na">requests</span><span class="pi">:</span>
                <span class="na">memory</span><span class="pi">:</span> <span class="s">64Mi</span>
                <span class="na">cpu</span><span class="pi">:</span> <span class="s">150m</span>
</code></pre></div></div>

<p>In the above yaml snippet, <code class="language-plaintext highlighter-rouge">podSpec</code> is a Kubernetes podspec, which consists of one or more containers that contain the user code to be run. In addition, the job specification (jobspec) contains metadata fields specific to Armada:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">queue</code>: which of the available job queues the job should be submitted to.</li>
  <li><code class="language-plaintext highlighter-rouge">priority</code>: the job priority (lower values indicate higher priority).</li>
  <li><code class="language-plaintext highlighter-rouge">jobSetId</code>: jobs with the same <code class="language-plaintext highlighter-rouge">jobSetId</code> can be followed and cancelled in a single operation. The <code class="language-plaintext highlighter-rouge">jobSetId</code> has no impact on scheduling.</li>
</ul>

<p>Resource requests and limits must be equal. Armada does not yet support limit &gt; request.</p>

<p>Now, the job can be submitted to Armada using the <code class="language-plaintext highlighter-rouge">armadactl</code> command-line utility (or alternatively via Armada’s gRPC or REST API). In particular, run</p>

<p><code class="language-plaintext highlighter-rouge">armadactl submit &lt;jobspec.yaml&gt;</code>,</p>

<p>where <code class="language-plaintext highlighter-rouge">&lt;jobspec.yaml&gt;</code> is the path of the file containing the jobspec. Armada automatically handles creating and running the necessary containers.</p>

<h2 id="multi-node-jobs">Multi-node jobs</h2>

<p>All containers part of the same podspec will be run on the same node (a physical or virtual machine), i.e., the amount of CPU and memory the above job could consume is limited by what the nodes that make up the clusters are equipped with. To overcome this limitation, jobs need to specify several podspecs, each of which may be scheduled on different nodes within a Kubernetes cluster. For example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">queue</span><span class="pi">:</span> <span class="s">test</span>
<span class="na">jobSetId</span><span class="pi">:</span> <span class="s">set1</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">priority</span><span class="pi">:</span> <span class="m">0</span>
    <span class="na">podSpecs</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">terminationGracePeriodSeconds</span><span class="pi">:</span> <span class="m">0</span>
        <span class="na">restartPolicy</span><span class="pi">:</span> <span class="s">Never</span>
        <span class="na">containers</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">sleep</span>
            <span class="na">imagePullPolicy</span><span class="pi">:</span> <span class="s">IfNotPresent</span>
            <span class="na">image</span><span class="pi">:</span> <span class="s">busybox:latest</span>
            <span class="na">args</span><span class="pi">:</span>
              <span class="pi">-</span> <span class="s">sleep</span>
              <span class="pi">-</span> <span class="s">60s</span>
            <span class="na">resources</span><span class="pi">:</span>
              <span class="na">limits</span><span class="pi">:</span>
                <span class="na">memory</span><span class="pi">:</span> <span class="s">64Mi</span>
                <span class="na">cpu</span><span class="pi">:</span> <span class="s">150m</span>
              <span class="na">requests</span><span class="pi">:</span>
                <span class="na">memory</span><span class="pi">:</span> <span class="s">64Mi</span>
                <span class="na">cpu</span><span class="pi">:</span> <span class="s">150m</span>
      <span class="pi">-</span> <span class="na">terminationGracePeriodSeconds</span><span class="pi">:</span> <span class="m">0</span>
        <span class="na">restartPolicy</span><span class="pi">:</span> <span class="s">Never</span>
        <span class="na">containers</span><span class="pi">:</span>
          <span class="s">...</span>
</code></pre></div></div>

<p>All pods part of the same job will be run simultaneously and within a single Kubernetes cluster. If any of the pods that make up the job fails to start within a certain timeout (specified by the <code class="language-plaintext highlighter-rouge">stuckPodExpiry</code> parameter), the entire job is cancelled and all pods belonging to it removed. Armada may attempt to re-schedule jobs experiencing transient issues. Events relating to a multi-node job contain a <code class="language-plaintext highlighter-rouge">podNumber</code> identifier, corresponding to the index of pod in the <code class="language-plaintext highlighter-rouge">podSpecs</code> list that the event refers to.</p>

<p>Jobs are submitted using either the <code class="language-plaintext highlighter-rouge">armadactl</code> command-line utility, with <code class="language-plaintext highlighter-rouge">armadactl submit &lt;jobspec.yaml&gt;</code>, or using the gRPC or REST API.</p>

<h2 id="job-options">Job options</h2>

<p>Here, we give a complete example of an Armada jobspec with all available parameters.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">queue</span><span class="pi">:</span> <span class="s">example</span>                            <span class="c1"># 1.</span>
<span class="na">jobSetId</span><span class="pi">:</span> <span class="s">test</span>                            <span class="c1"># 2.</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">priority</span><span class="pi">:</span> <span class="m">1000</span>                        <span class="c1"># 3.</span>
    <span class="na">namespace</span><span class="pi">:</span> <span class="s">example</span>                    <span class="c1"># 4.</span>
    <span class="na">clientId</span><span class="pi">:</span> <span class="m">12345</span>                       <span class="c1"># 5.</span>
    <span class="na">labels</span><span class="pi">:</span>                               <span class="c1"># 6.</span>
      <span class="na">example-label</span><span class="pi">:</span> <span class="s2">"</span><span class="s">value"</span>
    <span class="na">annotations</span><span class="pi">:</span>                          <span class="c1"># 7.</span>
      <span class="na">example-annotation</span><span class="pi">:</span> <span class="s2">"</span><span class="s">value"</span>
    <span class="na">ingress</span><span class="pi">:</span>                              <span class="c1"># 8.</span>
      <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">NodePort</span>
        <span class="na">ports</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="m">5050</span>
    <span class="na">podSpecs</span><span class="pi">:</span>                             <span class="c1"># 9.</span>
      <span class="pi">-</span> <span class="na">containers</span><span class="pi">:</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s">app</span>
        <span class="na">imagePullPolicy</span><span class="pi">:</span> <span class="s">IfNotPresent</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">vad1mo/hello-world-rest:latest</span>
        <span class="na">securityContext</span><span class="pi">:</span>
          <span class="na">runAsUser</span><span class="pi">:</span> <span class="m">1000</span>
        <span class="na">resources</span><span class="pi">:</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s">1Gi</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="m">1</span>
          <span class="na">requests</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s">1Gi</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="m">1</span>
        <span class="na">ports</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">5050</span>
            <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">http</span>
</code></pre></div></div>

<p>Using this format, it is possible to submit a job set composed of several jobs. The meaning of each field is:</p>

<ol>
  <li>The queue this job will be submitted to.</li>
  <li>Name of the job set this job belongs to.</li>
  <li>Relative priority of the job.</li>
  <li>The namespace that the pods part of this job will be created in (the <code class="language-plaintext highlighter-rouge">default</code> namespace if not specified).</li>
  <li>An optional ID that can be set to ensure that jobs are not duplicated, e.g., in case of certain network failures. Armada automatically discards any jobs submitted with a <code class="language-plaintext highlighter-rouge">clientId</code> equal to that of an existing job.</li>
  <li>List of labels that are added to all pods created as part of this job..</li>
  <li>List annotations that are added to all pods created as part of this job.</li>
  <li>List of ports that are exposed with the specified ingress type. The ingress only exposes ports for pods that also expose the corresponding port via the <code class="language-plaintext highlighter-rouge">containerPort</code> setting.</li>
  <li>List of podspecs that make up the job; see the <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.19/">Kubernetes documentation</a> for an overview of the available parameters.</li>
</ol>

    </div>
  </div>


  <footer class="footer mt-5 pt-4">
  <div class="container">
    <div class="row row-grid align-items-center mb-2 mt-2">
      <div class="col-lg-6">
        <h4 class="mb-0 font-weight-light">Armada Project</h4>
      </div>
      <div class="col-lg-6 text-lg-right">
        
    

    
    <button onclick="location.href='https://github.com/G-Research/armada/discussions';" rel="nofollow" class="btn btn-icon-only btn-discussions rounded-circle" data-toggle="tooltip" data-original-title="Discussions">
        <span class="btn-inner--icon">
            <i class="fab fa-discussions" aria-hidden="true"></i>
        </span>
    </button>
    

    
    <button onclick="location.href='https://twitter.com/GRESEARCHjobs';" rel="nofollow" class="btn btn-icon-only btn-twitter rounded-circle" data-toggle="tooltip" data-original-title="Twitter">
        <span class="btn-inner--icon">
            <i class="fab fa-twitter" aria-hidden="true"></i>
        </span>
    </button>
    

    

    

    

    

    

    

    

    
    <button onclick="location.href='https://github.com/G-Research/armada';" rel="nofollow" class="btn btn-icon-only btn-github rounded-circle" data-toggle="tooltip" data-original-title="Github">
        <span class="btn-inner--icon">
            <i class="fab fa-github" aria-hidden="true"></i>
        </span>
    </button>
    

    

    

      </div>
    </div>
    <hr>
    <div class="row align-items-center justify-content-md-between">
      <div class="col-md-6">
        <div class="copyright">
          <span> © 2022 Armada Project</span>
        </div>
      </div>
      <div class="col-md-6">
        <ul class="nav nav-footer justify-content-end">
          
          
          <li class="nav-item">
            <a href="/design" class="nav-link">
              <span class="nav-link-inner--text">Design</span>
            </a>
          </li>
          
          
          
          <li class="nav-item">
            <a href="" class="nav-link">
              <span class="nav-link-inner--text">Documentation</span>
            </a>
          </li>

          
          
          
          <li class="nav-item">
            <a href="/quickstart" class="nav-link">
              <span class="nav-link-inner--text">Quickstart</span>
            </a>
          </li>
          
          
          
          <li class="nav-item">
            <a href="/contribute" class="nav-link">
              <span class="nav-link-inner--text">Contribute</span>
            </a>
          </li>
          
          
        </ul>
      </div>
    </div>
  </div>
</footer>



<!--   Core JS Files   -->
<script src="/assets/js/core/jquery.min.js" type="text/javascript"></script>
<script src="/assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="/assets/js/core/bootstrap.min.js" type="text/javascript"></script>
<script src="/assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
<!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
<script src="/assets/js/plugins/bootstrap-switch.js"></script>
<!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
<script src="/assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
<!--  Plugin for the Carousel, full documentation here: http://jedrzejchalubek.com/ -->
<script src="/assets/js/plugins/glide.js" type="text/javascript"></script>
<!--  Plugin for the DatePicker, full documentation here: https://flatpickr.js.org/ -->
<script src="/assets/js/plugins/moment.min.js"></script>
<!--	Plugin for Select, full documentation here: https://joshuajohnson.co.uk/Choices/ -->
<script src="/assets/js/plugins/choices.min.js" type="text/javascript"></script>
<!--  Plugin for the DateTimePicker, full documentation here: https://flatpickr.js.org/ -->
<script src="/assets/js/plugins/datetimepicker.js" type="text/javascript"></script>
<!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
<script src="/assets/js/plugins/jasny-bootstrap.min.js"></script>
<!-- Plugin for Headrom, full documentation here: https://wicky.nillia.ms/headroom.js/ -->
<script src="/assets/js/plugins/headroom.min.js"></script>
<!-- Control Center for Argon UI Kit: parallax effects, scripts for the example pages etc -->

<script>
  // Blog Post Carousel
  if (document.querySelector('.blogGlide') !== null) {
    new Glide('.blogGlide', {
      type: 'carousel',
      startAt: 0,
      focusAt: 2,
      perTouch: 1,
      perView: 4
    }).mount();
  }

  if (document.querySelector('.glide') !== null) {
    // Generic
     new Glide('.glide', {
      type: 'carousel',
      startAt: 0,
      focusAt: 2,
      perTouch: 1,
      perView: 4
    }).mount();
  }

  if (document.querySelector('.testimonial-glide') !== null) {
    // Testimonial Carousel
    new Glide('.testimonial-glide', {
      type: 'carousel',
      startAt: 0,
      focusAt: 2,
      perTouch: 1,
      perView: 4
    }).mount();
  }

</script>

<script>
  $(function () {
    var navOffset = $('#navbar-main').height();
    $('.contentWrapper').css('padding-top', navOffset * 2 + 'px');
  });    
</script>



<script src="/assets/js/argon-design-system.min.js?v=1.0.0" type="text/javascript"></script>

  

</body>

</html>
</body>

</html>
