apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "armada.config.name" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "armada.labels.all" . | nindent 4 }}
data:
  {{ include "armada.config.filename" . }}: |
{{- if .Values.applicationConfig }}
{{ toYaml .Values.applicationConfig | indent 4 }}
{{- end }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "armada.logging.config.name" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "armada.labels.all" . | nindent 4 }}
data:
  {{ include "armada.logging.config.filename" . }}: |
{{- if .Values.logging }}
{{ toYaml .Values.logging | indent 4 }}
{{- end }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "armada.filebeat.config.name" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "armada.labels.all" . | nindent 4 }}
data:
  filebeat.yml: |-
    filebeat.inputs:
      - type: log
        enabled: true
        paths:
          - /log/*.json
    processors:
      - add_fields:
          target: ""
          fields:
            app: "armada-server"
    output.logstash:
      hosts: ["${LOGSTASH_HOST}:${LOGSTASH_PORT}"]
